#!/usr/bin/env python
# coding: utf-8

# In[ ]:


from flask import Flask, request
import random

app = Flask(__name__)

COUPONS = [
    "–í–µ—á—ñ—Ä —Ä–µ–ª–∞–∫—Å—É üïØÔ∏è\n–Ø –ø–æ–≤–Ω—ñ—Å—Ç—é –æ—Ä–≥–∞–Ω—ñ–∑–æ–≤—É—é –≤—Å–µ, —â–æ–± —Ç–∏ —Ç—ñ–ª–µ—Å–Ω–æ –π –µ–º–æ—Ü—ñ–π–Ω–æ —Ä–æ–∑—Å–ª–∞–±–∏–≤—Å—è –Ω–∞ –ø–æ–≤–Ω—É: –ø—Ä–æ—Å—Ç—ñ—Ä, –∞—Ç–º–æ—Å—Ñ–µ—Ä–∞, –¥–æ—Ç–∏–∫–∏, –º–∞–ª–µ–Ω—å–∫—ñ —Ä–∏—Ç—É–∞–ª–∏ ‚Äî —Ç–∏ –ø—Ä–æ—Å—Ç–æ –ø—Ä–∏—Ö–æ–¥–∏—à —ñ –¥–æ–∑–≤–æ–ª—è—î—à —Å–æ–±—ñ –≤—ñ–¥–∫–ª—é—á–∏—Ç–∏—Å—è.",
    "10 —Ç–≤–æ—ó—Ö —Å–∏–ª—å–Ω–∏—Ö —Å—Ç–æ—Ä—ñ–Ω (–±–µ–∑ –±–∞–Ω–∞–ª—å—â–∏–Ω–∏) üß†\n–Ø –Ω–∞–∑–∏–≤–∞—é 10 —Ç–≤–æ—ó—Ö —Å–∏–ª—å–Ω–∏—Ö —Ä–∏—Å —ñ —è–∫–æ—Å—Ç–µ–π –∑ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏–º–∏ –ø—Ä–∏–∫–ª–∞–¥–∞–º–∏ –∑ –Ω–∞—à–æ–≥–æ –∂–∏—Ç—Ç—è ‚Äî –±–µ–∑ ¬´—Ç–∏ –∫—Ä–∞—Å–∏–≤–∏–π, —Ç–∏ —Ä–æ–∑—É–º–Ω–∏–π¬ª, –∞ —Ç–∞–∫, —è–∫ —è –Ω–∞—Å–ø—Ä–∞–≤–¥—ñ —Ç–µ–±–µ –±–∞—á—É.",
    "–Ø –≤ —Ä–µ–∂–∏–º—ñ —Ñ—ñ–Ω–∞–Ω—Å–æ–≤–æ–≥–æ –∞–Ω–∞–ª—ñ—Ç–∏–∫–∞ / –ø—Å–∏—Ö–æ–ª–æ–≥–∞ üìä\n–Ø –Ω–∞ –æ–¥–∏–Ω —Ä–∞–∑ –∑–º—ñ–Ω—é—é —Ä–æ–ª—å: –Ω–µ ¬´–¥—ñ–≤—á–∏–Ω–∞¬ª, –∞ —Ñ—ñ–Ω–∞–Ω—Å–æ–≤–∏–π –∞–Ω–∞–ª—ñ—Ç–∏–∫ –∞–±–æ –ø—Å–∏—Ö–æ–ª–æ–≥. –¢–∏ –¥–∞—î—à –∑–∞–ø–∏—Ç, –∞ —è –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é —Å–≤–æ—ó –ø—Ä–æ—Ñ–µ—Å—ñ–π–Ω—ñ –Ω–∞–≤–∏—á–∫–∏, —â–æ–± –¥–æ–ø–æ–º–æ–≥—Ç–∏ —Ä–æ–∑–∫–ª–∞—Å—Ç–∏ —Å–∏—Ç—É–∞—Ü—ñ—é –π –ø–æ–±–∞—á–∏—Ç–∏ –≤–∞—Ä—ñ–∞–Ω—Ç–∏ —Ä—ñ—à–µ–Ω—å.",
    "–í–∏–∫–æ–Ω—É—é –±—É–¥—å-—è–∫–µ —Ç–≤–æ—î –±–∞–∂–∞–Ω–Ω—è ‚ú®\n–Ø –≤–∏–∫–æ–Ω—É—é –±—É–¥—å-—è–∫–µ —Ç–≤–æ—î –±–∞–∂–∞–Ω–Ω—è (–∫—Ä—ñ–º –ø–µ—Ä–µ—ó–∑–¥—É üòÖ).",
    "¬´–†–µ–∞–ª—å–Ω–∞ –Ω–µ—Ä–µ–∞–ª—å–Ω–∞ –º—Ä—ñ—è¬ª üåå\n–¢–∏ –Ω–∞–∑–∏–≤–∞—î—à –æ–¥–Ω–µ —Å–≤–æ—î –±–∞–∂–∞–Ω–Ω—è, —è–∫–µ, —è–∫ —Ç–∏ –≤–≤–∞–∂–∞—î—à, –º–æ–∂–µ –Ω—ñ–∫–æ–ª–∏ –Ω–µ –∑–¥—ñ–π—Å–Ω–∏—Ç–∏—Å—è, –∞–ª–µ —Ç–æ–±—ñ –¥—É–∂–µ —Ö–æ—á–µ—Ç—å—Å—è. –Ø —Ä–æ–±–ª—é –º—ñ–Ω—ñ-–¥–æ—Å–ª—ñ–¥–∂–µ–Ω–Ω—è/–ø–ª–∞–Ω: —è–∫—ñ 1‚Äì3 —Ä–µ–∞–ª—ñ—Å—Ç–∏—á–Ω—ñ –∫—Ä–æ–∫–∏ –º–æ–∂—É—Ç—å –Ω–∞–±–ª–∏–∑–∏—Ç–∏ —Ü—é –º—Ä—ñ—é, —ñ –º–∏ —Ä–∞–∑–æ–º —ó—Ö —Ä–æ–±–∏–º–æ.",
    "–¢–∞–Ω—Ç—Ä–∏—á–Ω–∏–π –¥–æ—Å–≤—ñ–¥ ¬´—è —Ç–æ—Ä–∫–∞—é—Å—è ‚Äî —Ç–∏ –∫–µ—Ä—É—î—à¬ª üî•\n–Ø —Ç–æ—Ä–∫–∞—é—Å—è —Ç–µ–±–µ, –∞ —Ç–∏ –∫–µ—Ä—É—î—à: –∫–∞–∂–µ—à, –¥–µ, —è–∫, —Å–∏–ª—å–Ω—ñ—à–µ —á–∏ –º‚Äô—è–∫—à–µ, —à–≤–∏–¥—à–µ —á–∏ –ø–æ–≤—ñ–ª—å–Ω—ñ—à–µ.",
    "¬´–°–ª—ñ–ø–∏–π –¥–æ—Ç–∏–∫¬ª üò∂‚Äçüå´Ô∏è\n–ú–∏ –∑–∞–≤‚Äô—è–∑—É—î–º–æ –æ—á—ñ ‚Äî —ñ —Ç–æ–±—ñ, —ñ –º–µ–Ω—ñ ‚Äî –π –¥–æ—Å–ª—ñ–¥–∂—É—î–º–æ –æ–¥–Ω–µ –æ–¥–Ω–æ–≥–æ —á–µ—Ä–µ–∑ –¥–æ—Ç–∏–∫. –¢–∏ —Ñ–æ–∫—É—Å—É—î—à—Å—è –Ω–∞ –≤—ñ–¥—á—É—Ç—Ç—è—Ö, –∞ –Ω–µ –Ω–∞ –∫–∞—Ä—Ç–∏–Ω—Ü—ñ.",
    "–©–æ –≤ —Ç–æ–±—ñ –Ω–µ–æ—á–µ–≤–∏–¥–Ω–æ –¥–ª—è —ñ–Ω—à–∏—Ö üîç\n–Ø –ø—Ä–æ–≥–æ–≤–æ—Ä—é —Ç–µ, —â–æ, –Ω–∞ –º–æ—é –¥—É–º–∫—É, –±—ñ–ª—å—à—ñ—Å—Ç—å –ª—é–¥–µ–π —É —Ç–æ–±—ñ –Ω–µ –±–∞—á–∞—Ç—å, –∞–ª–µ –±–∞—á—É —è: –ø—Ä–∏—Ö–æ–≤–∞–Ω—ñ —Å–∏–ª—å–Ω—ñ —Å—Ç–æ—Ä–æ–Ω–∏, –≥–ª–∏–±–∏–Ω—É, –Ω—é–∞–Ω—Å–∏ —Ö–∞—Ä–∞–∫—Ç–µ—Ä—É, —è–∫—ñ –¥–ª—è –º–µ–Ω–µ –¥—É–∂–µ —Ü—ñ–Ω–Ω—ñ.",
    "–ê–Ω—Ç–∏—Ç—Ä–∏–≤–æ–∂–Ω—ñ –¥—É–º–∫–∏ üß©\n–¢–∏ –¥—ñ–ª–∏—à—Å—è —Ç–∏–º, —â–æ —Ç–µ–±–µ —Ç—Ä–∏–≤–æ–∂–∏—Ç—å, –∞ –º–∏ —Ä–∞–∑–æ–º —Ü–µ –ø—Ä–æ–≥–æ–≤–æ—Ä—é—î–º–æ, —Ä–∞—Ü—ñ–æ–Ω–∞–ª—ñ–∑—É—î–º–æ, —à—É–∫–∞—î–º–æ –æ–ø–æ—Ä–∏. –Ø –ø—ñ–¥—Ç—Ä–∏–º—É—é —Ç–µ–±–µ, –∞ –Ω–µ –ø—Ä–æ—Å—Ç–æ –∫–∞–∂—É ¬´–Ω–µ –ø–µ—Ä–µ–∂–∏–≤–∞–π¬ª.",
    "–Ø–∫ —Ç–∏ –Ω–∞ –º–µ–Ω–µ –≤–ø–ª–∏–Ω—É–≤ üí´\n–Ø —Ä–æ–∑–ø–æ–≤—ñ–¥–∞—é 3‚Äì5 –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏—Ö –∑–º—ñ–Ω —É –º–µ–Ω—ñ, —è–∫—ñ —Å—Ç–∞–ª–∏—Å—è –∑–∞–≤–¥—è–∫–∏ —Ç–æ–±—ñ.",
    "–î–µ–Ω—å –±–µ–∑ —Ä—ñ—à–µ–Ω—å üßæ\n–£—Å—ñ –ø–æ–±—É—Ç–æ–≤—ñ –π –¥—Ä—ñ–±–Ω—ñ —Ä—ñ—à–µ–Ω–Ω—è —Ü—å–æ–≥–æ –¥–Ω—è –±–µ—Ä—É –Ω–∞ —Å–µ–±–µ.",
    "–†–µ–≤—ñ–∑—ñ—è —Ç–≤–æ—ó—Ö –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω—å üß±\n–ú–∏ —Ä–∞–∑–æ–º –¥–∏–≤–∏–º–æ—Å—è, –¥–µ —Ç–∏ –∑–∞—Ä–∞–∑ –ø–µ—Ä–µ–≤–∞–Ω—Ç–∞–∂–µ–Ω–∏–π, —ñ —è –ø—Ä–æ–ø–æ–Ω—É—é, —è–∫ —Ç–µ–±–µ —Ä–æ–∑–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏.",
    "–§—ñ–Ω–∞–Ω—Å–æ–≤–∞ / –∂–∏—Ç—Ç—î–≤–∞ –∫–∞—Ä—Ç–∞ üó∫Ô∏è\n–ú–∏ —Ä–∞–∑–æ–º –º–∞–ª—é—î–º–æ –∫–∞—Ä—Ç—É —Ç–≤–æ—ó—Ö —Ü—ñ–ª–µ–π —ñ —Ä–∏–∑–∏–∫—ñ–≤, –∞ —è –ø–æ–∫–∞–∑—É—é, –¥–µ –º–æ–∂—É –±—É—Ç–∏ —Ç–≤–æ—ó–º ¬´—Ö–µ–¥–∂–µ–º¬ª.",
    "–¢–≤—ñ–π –¥–µ–Ω—å –µ–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—É üé≤\n–Ø —Å—Ç–≤–æ—Ä—é—é —É–º–æ–≤–∏, —â–æ–± —Ç–∏ –∑—Ä–æ–±–∏–≤ —â–æ—Å—å, —á–æ–≥–æ –±–æ—ó—à—Å—è, –∞–ª–µ —Ö–æ—á–µ—à —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏.",
    "–¢–≤–æ—î —Ç–∞–±—É-–±–∞–∂–∞–Ω–Ω—è üîê\n–¢–∏ –Ω–∞–∑–∏–≤–∞—î—à –±–∞–∂–∞–Ω–Ω—è –∞–±–æ —Ñ–∞–Ω—Ç–∞–∑—ñ—é, —è–∫—É —Å–æ—Ä–æ–º–∏–≤—Å—è –æ–∑–≤—É—á–∏—Ç–∏. –ú–∏ –Ω–µ –∑–∞—Å—É–¥–∂—É—î–º–æ.",
    "–ö—É–ø–æ–Ω –Ω–∞ –∫—Ä–∏—Ç–∏–∫—É –±–µ–∑ –ø–æ–∫–∞—Ä–∞–Ω–Ω—è üõ°Ô∏è\n–¢–∏ –º–æ–∂–µ—à —Å–∫–∞–∑–∞—Ç–∏ –≤—Å–µ, —â–æ —Ç–µ–±–µ –¥—Ä–∞—Ç—É—î —á–∏ —Ä–∞–Ω–∏—Ç—å, –∞ —è –Ω–∞–º–∞–≥–∞—é—Å—è —â–∏—Ä–æ –ø–æ—á—É—Ç–∏.",
    "–¢–≤—ñ–π —Å—Ç—Ä–∞—Ö —â–æ–¥–æ –Ω–∞—à–æ–≥–æ –º–∞–π–±—É—Ç–Ω—å–æ–≥–æ üåßÔ∏è\n–¢–∏ —Ñ–æ—Ä–º—É–ª—é—î—à –Ω–∞–π–±—ñ–ª—å—à–∏–π —Å—Ç—Ä–∞—Ö –ø—Ä–æ ¬´–Ω–∞—Å¬ª, –∞ –º–∏ –¥–∏–≤–∏–º–æ—Å—è –Ω–∞ –Ω—å–æ–≥–æ —è–∫ –Ω–∞ —Å–ø—ñ–ª—å–Ω—É –∑–∞–¥–∞—á—É.",
    "–Ø–∫–±–∏ —è –º–æ–≥–ª–∞ –∑–Ω–∏–∫–Ω—É—Ç–∏ –Ω–∞ –¥–µ–Ω—å üï≥Ô∏è\n–¢–∏ —á–µ—Å–Ω–æ –≥–æ–≤–æ—Ä–∏—à, —â–æ –±–∏ —Ä–æ–±–∏–≤ —ñ –≤—ñ–¥—á—É–≤–∞–≤, —è–∫–±–∏ —è –Ω–∞ –¥–µ–Ω—å –∑–Ω–∏–∫–ª–∞.",
    "¬´–Ø ‚Äî —Ç–≤—ñ–π –∞–¥–≤–æ–∫–∞—Ç¬ª ‚öñÔ∏è\n–¢–∏ –æ–ø–∏—Å—É—î—à —Å–∏—Ç—É–∞—Ü—ñ—é, –¥–µ —Ç–µ–±–µ –Ω–µ –∑—Ä–æ–∑—É–º—ñ–ª–∏, –∞ —è —Ñ–æ—Ä–º—É–ª—é—é –ø—Ä–æ–º–æ–≤—É –Ω–∞ —Ç–≤–æ—î–º—É –±–æ—Ü—ñ.",
    "–ü–æ–≥–ª—è–¥ –±–µ–∑ —Å–ª—ñ–≤ ‚Äî 5 —Ö–≤–∏–ª–∏–Ω üëÅÔ∏è\n–ú–∏ 5 —Ö–≤–∏–ª–∏–Ω –¥–∏–≤–∏–º–æ—Å—è –æ–¥–Ω–µ –æ–¥–Ω–æ–º—É –≤ –æ—á—ñ –π –º–æ–≤—á–∏–º–æ, –ø–æ—Ç—ñ–º –∫–æ–∂–µ–Ω –∫–∞–∂–µ –ø–æ –æ–¥–Ω–æ–º—É —Ä–µ—á–µ–Ω–Ω—é.",
    "–¢–≤–æ—è —Ç—ñ–Ω—å–æ–≤–∞ —Å—Ç–æ—Ä–æ–Ω–∞ üåó\n–¢–∏ —Ä–æ–∑–ø–æ–≤—ñ–¥–∞—î—à –ø—Ä–æ —Ä–∏—Å—É, —è–∫—É –≤–≤–∞–∂–∞—î—à ¬´–ø–æ–≥–∞–Ω–æ—é¬ª, –∞ —è –æ–ø–∏—Å—É—é —ó—ó –∑ –ø–æ–≤–∞–≥–æ—é –π –ø—Ä–∏–π–Ω—è—Ç—Ç—è–º.",
]

math_tasks = [
    ("17 + 25 = ?", "42"),
    ("144 √∑ 12 = ?", "12"),
    ("9 √ó 7 = ?", "63"),
    ("50 - 17 = ?", "33"),
]

riddles = [
    ("–©–æ –º–æ–∂–Ω–∞ –ø–æ–±–∞—á–∏—Ç–∏ —ñ–∑ –∑–∞–∫—Ä–∏—Ç–∏–º–∏ –æ—á–∏–º–∞?", "—Å–æ–Ω"),
    ("–©–æ –Ω–∞–ª–µ–∂–∏—Ç—å —Ç–æ–±—ñ, –∞–ª–µ —ñ–Ω—à—ñ –∫–æ—Ä–∏—Å—Ç—É—é—Ç—å—Å—è —Ü–∏–º —á–∞—Å—Ç—ñ—à–µ?", "—ñ–º'—è"),
    ("–©–æ —Ç—Ä–∏–º–∞—î –≤–æ–¥—É, —Ö–æ—á–∞ –º–∞—î –¥—ñ—Ä–∫–∏?", "–≥—É–±–∫–∞"),
]

HTML_PAGE = """
<!doctype html>
<html lang="uk">
<head>
  <meta charset="utf-8">
  <title>–ö—É–ø–æ–Ω–∏ —Ç—É—Ä–±–æ—Ç–∏ üíå</title>
  <style>
    body {{ font-family: system-ui, sans-serif; background:#111; color:#f5f5f5; text-align:center; padding:40px; }}
    .card {{ max-width:650px; margin:0 auto; padding:24px; border-radius:16px; background:#1e1e1e; box-shadow:0 0 20px rgba(0,0,0,0.6); }}
    button {{ margin-top:20px; padding:10px 24px; border-radius:999px; border:none; background:#ff4b8b; color:white; font-size:16px; cursor:pointer; }}
    button:hover {{ background:#ff2f76; }}
    .coupon {{ margin-top:20px; font-size:18px; line-height:1.5; white-space:pre-line; }}
    .left {{ margin-top:10px; font-size:14px; color:#aaaaaa; }}
    .task {{ margin-top:20px; font-size:16px; }}
    input[type=text] {{ margin-top:10px; padding:8px 14px; border-radius:999px; border:none; width:70%; }}
    .msg {{ margin-top:10px; font-size:14px; color:#ffb3c9; }}
  </style>
</head>
<body>
<div class="card">
  <h1>–ú–µ–Ω—é –∫—É–ø–æ–Ω—ñ–≤ —Ç—É—Ä–±–æ—Ç–∏ üíå</h1>
  <p>–í–∏–∫–æ–Ω–∞–π –º–∞–ª–µ–Ω—å–∫–µ –∑–∞–≤–¥–∞–Ω–Ω—è ‚Äî —ñ –≤—ñ–¥–∫—Ä–∏–π –∫—É–ø–æ–Ω üôÇ</p>

  <form method="post">
    <div class="task">
      {task_text}
      {input_field}
    </div>
    <button type="submit">üéÅ –ü–æ–∫–∞–∑–∞—Ç–∏ –∫—É–ø–æ–Ω</button>
  </form>

  {message_block}
  {coupon_block}

  <div class="left">
    –ó–∞–ª–∏—à–∏–ª–æ—Å—å –∫—É–ø–æ–Ω—ñ–≤: {left}
  </div>
</div>
</body>
</html>
"""

current_task = None
coupons_left = COUPONS.copy()

def new_task():
    global current_task
    mode = random.choice(["sweet", "math", "riddle"])
    if mode == "sweet":
        current_task = {"type": "sweet", "question": "–ù–∞–ø–∏—à–∏ —â–æ—Å—å –ø—Ä–∏—î–º–Ω–µ –ø—Ä–æ –º–µ–Ω–µ –∞–±–æ –ø—Ä–æ –Ω–∞—Å üíå", "answer": None}
    elif mode == "math":
        q, a = random.choice(math_tasks)
        current_task = {"type": "math", "question": f"üî¢ –õ–µ–≥–∫–∞ –∑–∞–¥–∞—á–∫–∞: {q}", "answer": a}
    else:
        q, a = random.choice(riddles)
        current_task = {"type": "riddle", "question": f"üß© –ú—ñ–Ω—ñ-–∑–∞–≥–∞–¥–∫–∞: {q}", "answer": a}

new_task()

@app.route("/", methods=["GET", "POST"])
def index():
    global coupons_left, current_task
    message = ""
    coupon_html = ""
    task_text = current_task["question"]
    input_field = '<input type="text" name="answer" placeholder="–í—ñ–¥–ø–æ–≤—ñ–¥—å —Ç—É—Ç...">'
    if request.method == "POST":
        ans = request.form.get("answer", "").strip()
        if current_task["type"] == "sweet":
            if not ans:
                message = "–•–æ—á–∞ –± –æ–¥–Ω–µ —Å–ª–æ–≤–æ üôÇ"
            else:
                pass
        elif current_task["type"] == "math":
            if ans != current_task["answer"]:
                message = "–ù–µ –∑–æ–≤—Å—ñ–º —Ç–∞–∫ üòÑ –ú–æ–∂–µ—à —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ —ñ–Ω—à–µ –∑–∞–≤–¥–∞–Ω–Ω—è –Ω–∞—Å—Ç—É–ø–Ω–æ–≥–æ —Ä–∞–∑—É."
                html = HTML_PAGE.format(
                    task_text=task_text,
                    input_field=input_field,
                    message_block=f'<div class="msg">{message}</div>',
                    coupon_block="",
                    left=len(coupons_left),
                )
                return html
        else:
            if ans.lower() != current_task["answer"].lower():
                message = f"–ú–∞–ª–µ–Ω—å–∫–∏–π —Å–ø–æ–π–ª–µ—Ä: –≤—ñ–¥–ø–æ–≤—ñ–¥—å –±—É–ª–∞ ¬´{current_task['answer']}¬ª üòâ"

        if coupons_left:
            chosen = random.choice(coupons_left)
            coupons_left.remove(chosen)
            coupon_html = f"<div class='coupon'>{chosen}</div>"
            new_task()
            task_text = current_task["question"]
        else:
            message = "–£—Å—ñ –∫—É–ø–æ–Ω–∏ –≤–∂–µ –≤—ñ–¥–∫—Ä–∏—Ç—ñ üíå"

    html = HTML_PAGE.format(
        task_text=task_text,
        input_field=input_field,
        message_block=f'<div class="msg">{message}</div>' if message else "",
        coupon_block=coupon_html,
        left=len(coupons_left),
    )
    return html

if __name__ == "__main__":
    app.run()


# In[ ]:




